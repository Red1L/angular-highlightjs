/*! angular-highlightjs
version: 0.4.3
build date: 2015-09-06
author: Chih-Hsuan Fan
https://github.com/pc035860/angular-highlightjs.git */
!function(a,b){"object"==typeof exports||"object"==typeof module&&module.exports?module.exports=b(require("angular"),require("highlight.js")):"function"==typeof define&&define.amd?define(["angular","hljs"],b):a.returnExports=b(a.angular,a.hljs)}(this,function(a,b){function c(b){var c=!0;return a.forEach(["source","include"],function(a){b[a]&&(c=!1)}),c}var d=a.module("hljs",[]);d.provider("hljsService",function(){var c={};return{setOptions:function(b){a.extend(c,b)},getOptions:function(){return a.copy(c)},$get:function(){return(b.configure||a.noop)(c),b}}}),d.factory("hljsCache",["$cacheFactory",function(a){return a("hljsCache")}]),d.controller("HljsCtrl",["hljsCache","hljsService","$interpolate","$window","$log",function(b,c,d,e,f){function g(a,b,c){var d;return function(){var f=this,g=arguments,h=function(){d=null,c||a.apply(f,g)},i=c&&!d;e.clearTimeout(d),d=e.setTimeout(h,b),i&&a.apply(f,g)}}var h=this,i=null,j=null,k=null,l=!1,m=null,n=null;h.init=function(a){i=a},h.setInterpolateScope=function(a){l=a,k&&h.highlight(k)},h.setLanguage=function(a){j=a,k&&h.highlight(k)},h.highlightCallback=function(a){n=a},h._highlight=function(e){if(f.debug("# ctrl._highlight #"),i){var g,o;if(k=e,j?(o=h._cacheKey(j,k),g=b.get(o),g||(g=c.highlight(j,c.fixMarkup(k),!0),b.put(o,g))):(o=h._cacheKey(k),g=b.get(o),g||(g=c.highlightAuto(c.fixMarkup(k)),b.put(o,g))),l){(m||a.noop)();var p=d(g.value);m=l.$watch(p,function(a,b){a!==b&&i.html(a)}),i.html(p(l))}else i.html(g.value);i.addClass(g.language),null!==n&&a.isFunction(n)&&n()}},h.highlight=g(h._highlight,20,!0),h.clear=function(){i&&(k=null,i.text(""))},h.release=function(){i=null,l=null,(m||a.noop)(),m=null},h._cacheKey=function(){var a=Array.prototype.slice.call(arguments),b="!angular-highlightjs!";return a.join(b)}}]);var e,f,g,h,i;return e=["$parse",function(b){return{restrict:"EA",controller:"HljsCtrl",compile:function(d,e,f){var g=d[0].innerHTML.replace(/^(\r\n|\r|\n)/m,""),h=d[0].textContent.replace(/^(\r\n|\r|\n)/m,"");return d.html('<pre><code class="hljs"></code></pre>'),function(d,e,f,i){var j;if(a.isDefined(f.escape)?j=b(f.escape):a.isDefined(f.noEscape)&&(j=b("false")),i.init(e.find("code")),f.onhighlight&&i.highlightCallback(function(){d.$eval(f.onhighlight)}),(g||h)&&c(f)){var k;k=j&&!j(d)?h:g,i.highlight(k)}d.$on("$destroy",function(){i.release()})}}}}],g=function(b){return[function(){return{require:"?hljs",restrict:"A",link:function(c,d,e,f){f&&e.$observe(b,function(b){a.isDefined(b)&&f.setLanguage(b)})}}}]},f=function(a){return[function(){return{require:"?hljs",restrict:"A",link:function(b,c,d,e){e&&b.$watch(d[a],function(a,c){(a||a!==c)&&e.setInterpolateScope(a?b:null)})}}}]},h=function(a){return[function(){return{require:"?hljs",restrict:"A",link:function(b,c,d,e){e&&b.$watch(d[a],function(a,b){a?e.highlight(a):e.clear()})}}}]},i=function(b){return["$http","$templateCache","$q",function(c,d,e){return{require:"?hljs",restrict:"A",compile:function(f,g,h){var i=g[b];return function(b,f,g,h){var j=0;h&&b.$watch(i,function(b){var f=++j;if(b&&a.isString(b)){var g,i;g=d.get(b),g||(i=e.defer(),c.get(b,{cache:d,transformResponse:function(a,b){return a}}).success(function(a){f===j&&i.resolve(a)}).error(function(){f===j&&h.clear(),i.resolve()}),g=i.promise),e.when(g).then(function(b){b&&(a.isArray(b)?b=b[1]:a.isObject(b)&&(b=b.data),b=b.replace(/^(\r\n|\r|\n)/m,""),h.highlight(b))})}else h.clear()})}}}}]},d.directive("hljs",e).directive("interpolate",f("interpolate")).directive("compile",f("compile")).directive("language",g("language")).directive("source",h("source")).directive("include",i("include")),"hljs"});